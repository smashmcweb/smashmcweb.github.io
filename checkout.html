<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>MediaMC Checkout</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  margin:0;
  font-family:'Segoe UI',Arial;
  background:radial-gradient(circle at top,#1e3a8a,#020617 70%);
  color:#fff;
}
header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:15px 25px;
  background:linear-gradient(90deg,#020617,#0f172a);
  border-bottom:2px solid #38bdf8;
}
.brand{font-size:1.4em;font-weight:bold;color:#38bdf8;}
.userBox{display:flex;align-items:center;gap:12px;}
.userBadge{
  background:#020617;
  border:1px solid #38bdf8;
  padding:6px 10px;
  border-radius:8px;
  color:#bae6fd;
}
.logout{
  background:#0f172a;
  border:1px solid #38bdf8;
  color:#38bdf8;
  padding:6px 10px;
  border-radius:8px;
  cursor:pointer;
}
.container{
  max-width:800px;
  margin:30px auto;
  padding:20px;
  background:rgba(2,6,23,0.85);
  border:2px solid #38bdf8;
  border-radius:12px;
}
.orderItem{
  border-bottom:1px solid #38bdf8;
  padding:10px 0;
}
.orderItem b{color:#38bdf8;}
.totalBox{
  text-align:right;
  margin-top:20px;
  font-size:1.2em;
}
.backBtn{
  margin-top:20px;
  background:#0f172a;
  border:1px solid #38bdf8;
  color:#38bdf8;
  padding:8px 12px;
  border-radius:8px;
  cursor:pointer;
}
.infoBox{
  background:rgba(0,10,30,0.7);
  padding:12px;
  border:1px solid #38bdf8;
  border-radius:8px;
  margin-top:20px;
}
</style>
</head>
<body>

<header>
  <div class="brand">MediaMC Checkout</div>
  <div class="userBox">
    <div class="userBadge" id="nickLabel"></div>
    <button class="logout" onclick="logout()">Logout</button>
  </div>
</header>

<div class="container">
  <h2>Ordine ID: <span id="orderId"></span></h2>
  <p>Nick: <span id="orderNick"></span></p>

  <div id="productsList"></div>
  <div class="totalBox" id="totalBox"></div>

  <div class="infoBox">
    <p><b>Pagamento:</b></p>
    <p>Intestatario: <strong>MediaMC Network</strong></p>
    <p>Causale: <strong>ID Ordine</strong></p>
    <p>Apri un ticket nel nostro Discord per confermare il pagamento e ricevere i prodotti</p>
  </div>

  <button class="backBtn" onclick="backToStore()">← Torna allo Store</button>
</div>

<script>
let nick = sessionStorage.getItem('nick');
if(!nick){ alert('Devi prima inserire il nick nello store'); location.href='store.html'; }
else document.getElementById('nickLabel').textContent = 'Player: '+nick;

function logout(){
  sessionStorage.removeItem('nick');
  location.href='store.html';
}

// --- Legge ID ordine dalla query string ---
function getOrderId(){
  const params = new URLSearchParams(window.location.search);
  return params.get('id');
}

function loadOrder(){
  const id = getOrderId();
  document.getElementById('orderId').textContent = id || 'Sconosciuto';
  const orders = JSON.parse(localStorage.getItem('checkoutDataList'))||[];
  const order = orders.find(o=>o.id===id);
  if(!order){
    document.getElementById('productsList').innerHTML='<p>Ordine non trovato o carrello vuoto</p>';
    document.getElementById('totalBox').textContent='';
    return;
  }
  document.getElementById('orderNick').textContent = order.nick;

  const plist = document.getElementById('productsList');
  plist.innerHTML='';
  order.cart.forEach(p=>{
    const div = document.createElement('div');
    div.className='orderItem';
    div.innerHTML=`<b>${p.name}</b> - €${p.price}`;
    plist.appendChild(div);
  });

  document.getElementById('totalBox').textContent='Totale: €'+order.total.toFixed(2);
}

function backToStore(){ location.href='store.html'; }

loadOrder();
</script>

</body>
</html>
