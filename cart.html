<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Carrello</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;font-family:Segoe UI;background:linear-gradient(135deg,#0ea5e9,#020617);color:#fff}
section{max-width:500px;margin:40px auto;background:rgba(2,6,23,.8);padding:20px;border-radius:12px;border:2px solid #38bdf8}
.item{display:flex;justify-content:space-between;margin:5px 0}
button{background:#38bdf8;border:none;border-radius:6px;padding:6px;color:#fff}
</style>
</head>
<body>

<section>
<h2>üõí Carrello</h2>
<div id="list"></div>
<p>Totale: ‚Ç¨<span id="total">0</span></p>
<button onclick="checkout()">Procedi Ordine</button>
<button onclick="location.href='store.html'">‚Üê Torna allo store</button>
</section>

<script>
const nick=localStorage.getItem('nick');
if(!nick){location.href='store.html';}

const key='cart_'+nick;
let cart=JSON.parse(localStorage.getItem(key))||[];

const list=document.getElementById('list');
let total=0;
cart.forEach((p,i)=>{
  total+=p.price;
  list.innerHTML+=`<div class="item">${p.name} ‚Ç¨${p.price}
  <button onclick="remove(${i})">X</button></div>`;
});
document.getElementById('total').textContent=total;

function remove(i){
  cart.splice(i,1);
  localStorage.setItem(key,JSON.stringify(cart));
  location.reload();
}

function checkout(){
  const id='MM-'+Math.floor(Math.random()*100000);
  const order={id,nick,cart,total};
  const orders=JSON.parse(localStorage.getItem('orders'))||[];
  orders.push(order);
  localStorage.setItem('orders',JSON.stringify(orders));
  localStorage.setItem('checkout',JSON.stringify(order));
  localStorage.removeItem(key);
  location.href='checkout.html';
}
</script>
</body>
</html>
